<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Damas vs IA â€” GrÃ£o-Mestre (IDS)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* (Todo o seu CSS <style>... </style> fica aqui, sem NENHUMA mudanÃ§a) */
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      background: #0f172a;
      transition: background 0.5s ease;
    }
    #board {
      display: grid;
      grid-template-columns: repeat(8, 1fr);
      aspect-ratio: 1 / 1;
      width: 100%;
      max-width: min(90vmin, 520px);
      border: 4px solid #334155;
      border-radius: 16px;
      overflow: hidden;
      margin: 0 auto;
    }
    .aspect-square{ aspect-ratio: 1/1; }
    .king::after{
      content:'ğŸ‘‘';
      position:absolute; top:50%; left:50%;
      transform: translate(-50%,-55%);
      font-size:1.1rem; opacity:.9; pointer-events:none;
    }
    @keyframes shake {
      0%{ transform:translate(0,0) }
      25%{ transform:translate(5px,-5px) }
      50%{ transform:translate(-5px,5px) }
      75%{ transform:translate(5px,5px) }
      100%{ transform:translate(0,0) }
    }
    .shake{ animation:shake .28s ease-in-out }
    .face-emoji {
      font-size: 5rem;
      line-height: 1;
      transform-origin: center;
      transition: transform .18s ease;
      position: relative;
      z-index: 10;
      cursor: default;
    }
    #face {
      transition: transform .2s ease, filter .2s ease, box-shadow .2s ease;
    }
    #bubbleText {
      transition: opacity 0.5s ease, transform 0.5s ease;
      transform: translateY(10px);
    }
    #bubble.show #bubblePlaceholder { opacity: 0; }
    #bubble.show #bubbleText {
      opacity: 1;
      transform: translateY(0);
    }
    .ring-red-500{ --tw-ring-color: rgb(239 68 68) }
    .ring-yellow-400{ --tw-ring-color: rgb(250 204 21) }
    .overlay{
      position:fixed; inset:0; display:flex; align-items:center; justify-content:center;
      background:rgba(0,0,0,.78); color:#fff; font-weight:800; font-size:2.25rem;
      letter-spacing:.5px; opacity:0; pointer-events:none; transition: opacity .45s ease;
      z-index:50; text-align:center; padding: 1rem;
    }
    .overlay.show{ opacity:1; pointer-events:auto }
    .manual-panel, .analysis-panel {
      transition: opacity 300ms ease-out, transform 300ms ease-out;
    }
    #btnMenuOpcoes {
      display: none;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    @keyframes slideFadeIn {
      from { opacity: 0; transform: translateY(-10px) scale(0.98); }
      to { opacity: 1; transform: translateY(0) scale(1); }
    }
    @keyframes slideFadeOut {
      from { opacity: 1; transform: translateY(0) scale(1); }
      to { opacity: 0; transform: translateY(-10px) scale(0.98); }
    }
    #menuFlutuante {
      opacity: 0;
      transform: translateY(-10px) scale(0.98);
      transition: opacity 0.25s ease, transform 0.25s ease;
    }
    #menuFlutuante.show {
      animation: slideFadeIn 0.25s forwards;
    }
    #menuFlutuante.hide {
      animation: slideFadeOut 0.25s forwards;
    }
    @keyframes pulseButton {
      0%, 100% { box-shadow: 0 0 20px rgba(56,189,248,0.3); }
      50% { box-shadow: 0 0 35px rgba(56,189,248,0.6); }
    }
    #btnStart { 
      animation: pulseButton 3s infinite ease-in-out; 
    }
    #btnManualMenu:hover { 
      background-color: #475569; 
      box-shadow: 0 0 15px rgba(56,189,248,0.3); 
    }
    #mainMenuScreen h1, #onlineMenuScreen h2, #createRoomScreen h2, #joinRoomScreen h2, #loginScreen h1, #registerScreen h1 { 
      animation: fadeIn 1.2s ease-out;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    #menuContainer {
      position: fixed;
      inset: 0;
      background: #0f172a;
      color: #e2e8f0;
      z-index: 50;
    }
    .menu-screen {
      position: absolute;
      inset: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      transition: opacity 0.4s ease, visibility 0.4s;
      visibility: visible;
      opacity: 1;
    }
    .menu-screen.hidden {
      opacity: 0;
      visibility: hidden;
      pointer-events: none;
    }
    #board {
      transition: transform 0.4s ease-in-out;
      transform-origin: center center;
    }
    .piece {
      transition: transform 0.4s ease-in-out;
    }
    #board.rot-180 { transform: rotate(180deg); }
    .piece.counter-rot { 
      transform: translate(-50%, -50%) rotate(180deg); 
    }
  </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-4">

  <div id="menuContainer" class="fixed inset-0 bg-slate-900 text-slate-200 z-50">
    
    <div id="loginScreen" class="menu-screen">
      <h1 class="text-4xl font-extrabold mb-8 text-cyan-300 drop-shadow-lg w-full text-center">Login</h1>
      <p id="loginError" class="text-red-400 mb-4 h-5"></p> <input id="inputNomeLogin" type="text" placeholder="Seu Nome"
        class="text-center bg-slate-800 border border-slate-600 rounded-xl px-6 py-3 mb-4 text-white w-60 uppercase tracking-widest" />
      
      <input id="inputPinLogin" type="password" placeholder="PIN de 4 dÃ­gitos" maxlength="4"
        class="text-center bg-slate-800 border border-slate-600 rounded-xl px-6 py-3 mb-6 text-white w-60 tracking-[.5em]" />
      
      <button id="btnLogin" class="bg-blue-600 hover:bg-blue-500 text-white px-6 py-3 rounded-xl w-60 mb-4">
        Entrar
      </button>
      
      <button id="btnGoToRegister" class="text-cyan-400 hover:text-cyan-300 w-60">
        NÃ£o tenho conta (Registrar)
      </button>
    </div>

    <div id="registerScreen" class="menu-screen hidden">
      <h1 class="text-4xl font-extrabold mb-8 text-cyan-300 drop-shadow-lg w-full text-center">Registrar</h1>
      <p id="registerError" class="text-red-400 mb-4 h-5"></p> <input id="inputNomeReg" type="text" placeholder="Crie seu Nome"
        class="text-center bg-slate-800 border border-slate-600 rounded-xl px-6 py-3 mb-4 text-white w-60 uppercase tracking-widest" />
      
      <input id="inputPinReg" type="password" placeholder="Crie um PIN de 4 dÃ­gitos" maxlength="4"
        class="text-center bg-slate-800 border border-slate-600 rounded-xl px-6 py-3 mb-6 text-white w-60 tracking-[.5em]" />
      
      <button id="btnRegister" class="bg-emerald-600 hover:bg-emerald-500 text-white px-6 py-3 rounded-xl w-60 mb-4">
        Criar Conta
      </button>
      
      <button id="btnGoToLogin" class="text-cyan-400 hover:text-cyan-300 w-60">
        JÃ¡ tenho conta (Login)
      </button>
    </div>

    <div id="mainMenuScreen" class="menu-screen hidden">
      <h1 class="text-4xl font-extrabold mb-8 text-cyan-300 drop-shadow-lg w-full text-center">Damas vs IA</h1>
      
      <p class="mb-4 text-slate-400">Logado como: <strong id="playerName" class="text-white">...</strong></p>

      <button id="btnStart" 
        class="bg-cyan-600 hover:bg-cyan-500 text-white text-lg px-6 py-3 rounded-xl shadow-[0_0_20px_rgba(56,189,248,0.5)] mb-4 transition w-60">
        ğŸ¤– Jogar vs IA
      </button>
    
      <div class="text-center mb-4" id="difficultyContainer">
        <p class="mb-2 text-slate-400">Dificuldade:</p>
        <select id="difficulty" class="bg-slate-800 border border-cyan-400/40 text-white px-4 py-2 rounded-lg w-60">
          <option value="easy">FÃ¡cil</option>
          <option value="medium" selected>MÃ©dio</option>
          <option value="hard">DifÃ­cil</option>
          <option value="master">Mestre</option>
        </select>
      </div>

      <button id="btnOnline" 
        class="bg-blue-600 hover:bg-blue-500 text-white text-lg px-6 py-3 rounded-xl shadow-[0_0_20px_rgba(96,165,250,0.5)] transition w-60">
        ğŸŒ Jogar Online
      </button>
    
      <button id="btnManualMenu"
        class="mt-6 bg-slate-700 hover:bg-slate-600 text-white px-5 py-2 rounded-lg shadow-md border border-slate-600 transition-all w-60">
        â“ InstruÃ§Ãµes
      </button>
    </div>

    <div id="onlineMenuScreen" class="menu-screen hidden">
       <h1 class="text-4xl font-extrabold mb-8 text-cyan-300 drop-shadow-lg w-full text-center">Jogar Online</h1>
      <button id="btnCriarSala" class="bg-blue-600 hover:bg-blue-500 text-white text-lg px-6 py-3 rounded-xl shadow-[0_0_20px_rgba(56,189,248,0.5)] mb-4 transition w-60">ğŸ†• Criar Sala</button>
      <button id="btnEntrarSala" class="bg-emerald-600 hover:bg-emerald-500 text-white text-lg px-6 py-3 rounded-xl shadow-[0_0_20px_rgba(16,185,129,0.5)] mb-4 transition w-60">ğŸ” Entrar em Sala</button>
      <button id="btnVoltarMenu" class="mt-4 bg-slate-700 hover:bg-slate-600 text-white px-5 py-2 rounded-lg shadow-md border border-slate-600 w-60">â¬…ï¸ Voltar</button>
    </div>
    
    <div id="createRoomScreen" class="menu-screen hidden">
      <h2 class="text-3xl font-bold mb-4 text-blue-300 drop-shadow-lg w-full text-center">ğŸ†• Criar Sala</h2>
      <p class="mb-2 text-slate-400">CÃ³digo da sala:</p>
      <div class="text-2xl font-mono bg-slate-800 border border-blue-500 rounded-xl px-6 py-3 mb-6">
        <span id="roomCode">-----</span>
      </div>
      <p class="text-slate-400 mb-8">Compartilhe este cÃ³digo com seu amigo para ele entrar na sala.</p>
      <button id="btnVoltarOnline1" class="bg-slate-800 hover:bg-slate-700 text-slate-300 px-5 py-2 rounded-lg w-60">
        â¬…ï¸ Voltar
      </button>
    </div>
    
    <div id="joinRoomScreen" class="menu-screen hidden">
      <h2 class="text-3xl font-bold mb-6 text-blue-300 drop-shadow-lg w-full text-center">ğŸ” Entrar em Sala</h2>
      <input id="inputRoomCode" type="text" placeholder="CÃ³digo da sala"
        class="text-center bg-slate-800 border border-blue-500 rounded-xl px-6 py-3 mb-6 text-white w-60 uppercase tracking-widest" />
      <button id="btnJoin" class="bg-blue-600 hover:bg-blue-500 text-white px-6 py-3 rounded-xl w-60 mb-4">
        ğŸšª Entrar
      </button>
      <button id="btnVoltarOnline2" class="bg-slate-800 hover:bg-slate-700 text-slate-300 px-5 py-2 rounded-lg w-60">
        â¬…ï¸ Voltar
      </button>
    </div>

  </div>
  <audio id="s-move" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg" preload="auto"></audio>
  <audio id="s-cap"  src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg" preload="auto"></audio>
  <audio id="s-win"  src="httpsactions.google.com/sounds/v1/cartoon/congratulations.ogg" preload="auto"></audio>
  <audio id="s-lose" src="https://actions.google.com/sounds/v1/cartoon/slide_whistle_to_boing.ogg" preload="auto"></audio>
  <audio id="s-desist" src="https://actions.google.com/sounds/v1/cartoon/slide_whistle_to_boing.ogg" preload="auto"></audio>

  <button id="btnMenuOpcoes" class="fixed top-4 right-4 text-slate-300 z-50 hover:text-cyan-400 transition">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-7 h-7">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6h.01M12 12h.01M12 18h.01" />
    </svg>
  </button>

  <div id="menuFlutuante" class="hidden fixed top-12 right-4 bg-slate-800 border border-cyan-400/40 rounded-xl shadow-xl z-50 p-2 w-40 text-sm text-slate-100">
    <button id="voltarMenu" class="block w-full text-left px-3 py-2 hover:bg-slate-700 rounded">â¬…ï¸ Voltar ao Menu</button>
    <button id="desistirJogo" class="block w-full text-left px-3 py-2 hover:bg-slate-700 rounded">ğŸ³ï¸ Desistir</button>
  </div>

  <div class="w-full max-w-2xl mx-auto flex justify-between items-stretch gap-4 px-1 mb-4 h-40 mt-6">
    <div id="face" class="flex-1 flex items-center justify-center p-4 rounded-xl border-2 border-slate-700 bg-slate-800 shadow-xl overflow-hidden relative">
      <div id="faceEmoji" class="face-emoji">ğŸ¤–</div>
    </div>
    <div id="bubble" class="flex-[2] flex items-center justify-center p-4 rounded-xl border-2 border-slate-700 bg-slate-800 shadow-xl relative text-center">
      <span id="bubblePlaceholder" class="text-slate-500 font-medium italic transition-opacity duration-300 opacity-100">IA estÃ¡ analisando...</span>
      <span id="bubbleText" class="absolute inset-4 flex items-center justify-center text-lg font-semibold text-slate-100 transition-opacity duration-300 opacity-0"></span>
    </div>
  </div>

  <div class="relative w-full max-w-2xl">
    <div id="board"></div>
  </div>

  <div id="overlay" class="overlay"></div>

  <div id="manualModal" class="hidden fixed inset-0 bg-black/70 flex items-center justify-center z-50 backdrop-blur-sm">
    <div class="manual-panel bg-gradient-to-b from-slate-900 to-slate-800 text-slate-200 border border-cyan-400/40 
                shadow-[0_0_25px_rgba(56,189,248,0.5)] p-6 rounded-2xl w-[90%] max-w-lg relative overflow-hidden transform scale-95 opacity-0">
      <div class="absolute inset-0 bg-gradient-to-tr from-cyan-500/10 via-transparent to-blue-500/10 blur-3xl"></div>
      <h2 class="text-2xl font-bold mb-3 text-center text-cyan-300 drop-shadow-lg">
        ğŸ“˜ Manual de InstruÃ§Ãµes
      </h2>
      <div class="text-sm leading-relaxed space-y-2 max-h-[60vh] overflow-y-auto relative z-10 px-1">
        <p><strong>ğŸ¯ Objetivo:</strong> Capturar todas as peÃ§as do inimigo ou deixÃ¡-lo sem jogadas.</p>
        <p><strong>ğŸ® Movimentos:</strong> Clique em uma peÃ§a sua para selecionar e escolha uma casa vÃ¡lida para mover.</p>
        <p><strong>âš”ï¸ Capturas:</strong> Pule sobre as peÃ§as inimigas para capturÃ¡-las. Capturas mÃºltiplas sÃ£o possÃ­veis.</p>
        <p><strong>ğŸ‘‘ PromoÃ§Ã£o:</strong> Ao chegar na linha final, a peÃ§a vira Dama (ğŸ‘‘) e pode mover-se em todas as direÃ§Ãµes.</p>
        <p><strong>ğŸ¤– Modo vs IA:</strong> A IA pensa, reage e evolui â€” mudando de estilo conforme as partidas.</p>
        <p><strong>ğŸŒ Modo Online:</strong> Jogue contra um amigo. Crie uma sala e compartilhe o cÃ³digo, ou entre em uma sala existente.</p>
        <p><strong>ğŸ VitÃ³ria:</strong> Vence quem deixar o oponente sem movimentos ou sem peÃ§as.</p>
        <p><strong>ğŸ’¡ Dica:</strong> Controle o centro e evite peÃ§as isoladas. Observe o comportamento da IA â€” ela aprende com vocÃª.</p>
      </div>
      <button id="closeManual" 
        class="mt-5 w-full bg-cyan-600 hover:bg-cyan-500 text-white py-2 rounded-lg shadow-lg relative z-10 transition duration-300">
        Fechar
      </button>
    </div>
  </div>

  <div id="analysisModal" 
    class="hidden fixed inset-0 bg-black/70 flex items-center justify-center z-50 backdrop-blur-sm">
    <div class="analysis-panel bg-gradient-to-b from-slate-900 to-slate-800 text-slate-200 border border-cyan-400/40 
                shadow-[0_0_25px_rgba(56,189,248,0.5)] p-6 rounded-2xl w-[90%] max-w-lg relative overflow-hidden transform scale-95 opacity-0">
      <h2 class="text-2xl font-bold mb-3 text-center text-cyan-300 drop-shadow-lg">
        ğŸ“Š AnÃ¡lise da Partida
      </h2>
      <div id="analysisContent" class="text-sm leading-relaxed space-y-2 max-h-[60vh] overflow-y-auto relative z-10 px-1">
      </div>
      <button id="closeAnalysis" 
        class="mt-5 w-full bg-cyan-600 hover:bg-cyan-500 text-white py-2 rounded-lg shadow-lg relative z-10 transition duration-300">
        Jogar Novamente (vs IA)
      </button>
      <button id="backToMenu"
        class="mt-3 w-full bg-slate-700 hover:bg-slate-600 text-white py-2 rounded-lg shadow-lg relative z-10 transition duration-300">
        â¬…ï¸ Voltar ao Menu
      </button>
    </div>
  </div>
  
  <audio id="openSound" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg" preload="auto"></audio>
  <audio id="closeSound" src="https://actions.google.com/sounds/v1/cartoon/pop.ogg" preload="auto"></audio>
  
  <script type="module" src="./js/ui.js"></script>

</body>
</html>